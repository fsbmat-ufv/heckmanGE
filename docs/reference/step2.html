<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>step2: Two-Step Estimation Function — step2 • heckmanGE</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="step2: Two-Step Estimation Function — step2"><meta name="description" content="This function performs a two-step estimation process, commonly used in models that require correction for sample selection bias. It estimates parameters for selection, outcome, and dispersion equations."><meta property="og:description" content="This function performs a two-step estimation process, commonly used in models that require correction for sample selection bias. It estimates parameters for selection, outcome, and dispersion equations."><meta property="og:image" content="/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heckmanGE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fsbmat-ufv/heckmanGE/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>step2: Two-Step Estimation Function</h1>
      <small class="dont-index">Source: <a href="https://github.com/fsbmat-ufv/heckmanGE/blob/HEAD/R/step2.R" class="external-link"><code>R/step2.R</code></a></small>
      <div class="d-none name"><code>step2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs a two-step estimation process, commonly used in models that require correction for sample selection bias. It estimates parameters for selection, outcome, and dispersion equations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step2</span><span class="op">(</span><span class="va">YS</span>, <span class="va">XS</span>, <span class="va">YO</span>, <span class="va">XO</span>, <span class="va">Msigma</span>, <span class="va">Mrho</span>, <span class="va">w</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ys">YS<a class="anchor" aria-label="anchor" href="#arg-ys"></a></dt>
<dd><p>A binary numeric vector indicating selection (1 if selected, 0 otherwise).</p></dd>


<dt id="arg-xs">XS<a class="anchor" aria-label="anchor" href="#arg-xs"></a></dt>
<dd><p>A numeric matrix of covariates for the selection equation. Rows correspond to observations and columns to covariates.</p></dd>


<dt id="arg-yo">YO<a class="anchor" aria-label="anchor" href="#arg-yo"></a></dt>
<dd><p>A numeric vector of observed outcomes for the selected sample (where <code>YS == 1</code>).</p></dd>


<dt id="arg-xo">XO<a class="anchor" aria-label="anchor" href="#arg-xo"></a></dt>
<dd><p>A numeric matrix of covariates for the outcome equation. Rows correspond to selected observations.</p></dd>


<dt id="arg-msigma">Msigma<a class="anchor" aria-label="anchor" href="#arg-msigma"></a></dt>
<dd><p>A numeric matrix of covariates for the dispersion equation.</p></dd>


<dt id="arg-mrho">Mrho<a class="anchor" aria-label="anchor" href="#arg-mrho"></a></dt>
<dd><p>A numeric matrix of covariates for the correlation structure equation.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A numeric vector of weights to be used in the estimation process.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the following elements:</p>
<dl><dt>selection</dt>
<dd><p>Estimated coefficients for the selection equation (probit model).</p></dd>

<dt>outcome</dt>
<dd><p>Estimated coefficients for the outcome equation (weighted least squares).</p></dd>

<dt>dispersion</dt>
<dd><p>Estimated coefficients for the dispersion equation (log of residual variance).</p></dd>

<dt>correlation</dt>
<dd><p>Initial guesses for the coefficients in the correlation structure.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements a two-step estimation method for models with sample
selection bias. The process begins by estimating the selection equation using
a probit model to model the probability of selection. The Inverse Mills Ratio (IMR)
is computed from the probit model and added as a covariate in the outcome and
dispersion equations to correct for sample selection bias.</p>
<p>The outcome equation is estimated using weighted least squares (WLS), where
the residuals are used to estimate the dispersion equation. Additionally,
initial estimates for the correlation structure are computed based on the
fitted values from the outcome equation.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://sandwich.R-Forge.R-project.org/reference/vcovHC.html" class="external-link">vcovHC</a></code> for computing robust standard errors.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Barbosa Rogério Jerônimo, Bastos Fernando de Souza, Prates Marcos Oliveira.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

